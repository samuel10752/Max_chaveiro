<!DOCTYPE html>
<html>

<head>
    <title>Cadastro de Endereço de Entrega</title>
    <meta charset="utf-8" />
    <style>
        /* Estilos para o modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);

        }

        .modal-content {
            border-radius: 3%;
            background-color: #fefefe;
            margin: 4% auto;
            padding: 10px;
            border: 1px solid #888;
            width: 53%;
            max-width: 1050px;
            height: 85%;
        }

        .close {
            color: #888;
            float: right;
            font-size: 68px;
            width: 50px;
            height: 50px;
            font-weight: bold;
            margin-right: -2%;
            margin-top: -2%;
            cursor: pointer;
        }

        .close:hover,
        .close:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        .comet-modal-title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            margin-left: 3%;
            font-weight: 700;
        }

        .next-row {
            margin: 0 -8px;
        }

        .next-col {
            padding: 0 8px;
        }

        .next-form-item {
            margin-bottom: 20px;
        }

        .next-input {
            width: 450px;
            height: 52px;
            padding: 8px;
            margin-left: 3%;
            border: 1px solid #ccc;
            border-radius: 7px;
            box-sizing: border-box;
        }

        .next-input-dd {
            width: 75px;
            height: 52px;
            padding: 8px;
            margin-left: 2%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .next-input-estado {
            width: 220px;
            height: 52px;
            padding: 8px;
            margin-left: 3%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .next-input-cidade {
            width: 225px;
            height: 52px;
            padding: 8px;
            margin-left: 0%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .next-input-cep {
            width: 165px;
            height: 52px;
            padding: 8px;
            margin-left: 2%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .next-input-prazo {
            width: 165px;
            height: 52px;
            padding: 8px;
            margin-top: 10px;
            margin-left: 0%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .next-input-frete {
            width: 137px;
            height: 52px;
            padding: 8px;
            margin-top: 10px;
            margin-left: 0%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }


        .next-input-telefone {
            width: 400px;
            height: 52px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .next-input-bairro {
            width: 477px;
            height: 52px;
            padding: 8px;
            margin-top: 10px;
            margin-left: 2%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .next-input-endereco {
            width: 450px;
            height: 52px;
            padding: 8px;
            margin-left: 3%;
            margin-top: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .next-input-apto {
            width: 450px;
            height: 52px;
            padding: 8px;
            margin-left: 3%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .next-input-numero {
            width: 477px;
            height: 52px;
            padding: 8px;
            margin-top: 10px;
            margin-left: 2%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }


        .alertas_1 {
            max-width: 900px;
            display: flex;
        }

        #warningMessage_nome {
            margin-left: 5%;
            margin-top: 10px;
        }

        #warningMessage_dd {
            margin-left: 40%;
            margin-top: 10px;
        }

        #warningMessage_telefone {
            margin-top: 10px;
        }


        .alertas_2 {
            max-width: 900px;
            display: flex;
        }

        #endereco-error {
            margin-left: 4%;
            margin-top: 10px;
        }

        #bairro-error {
            margin-left: 34%;
            margin-top: 10px;
        }

        .alertas_3 {
            max-width: 900px;
            display: flex;
        }

        #apto-error {
            margin-left: 4%;
            margin-top: 10px;
        }

        #numero-error {
            margin-left: 34%;
            margin-top: 10px;
        }

        .input-checkbox {
            position: absolute;
            display: auto;
            margin-left: 18%;
            margin-top: 10px;
            color: #007bff;
        }

        .checkbox-custom {
            display: none;
        }

        .checkbox-custom+label {
            position: relative;
            padding-left: 15px;
            cursor: pointer;
        }

        .checkbox-custom+label:before {
            content: '';
            position: absolute;
            left: 0;
            top: 4px;
            width: 10px;
            height: 10px;
            border: 2px solid #007bff;
            box-sizing: border-box;
        }

        .checkbox-custom:checked+label:after {
            content: '';
            position: absolute;
            left: 0px;
            top: 5px;
            width: 8px;
            height: 8px;
            background-color: #007bff;
        }

        .input-numero {
            margin-left: 49.5%;
            margin-top: -57px;
        }

        .input-apt {
            margin-left: 0%;
            margin-top: 0px;
        }

        .text_nome {
            margin-left: 4%;
        }

        .text_cep {
            margin-left: 41%;
        }

        .text_linha_1 {
            max-width: 900px;
            display: flex;
        }

        .text_frete {
            margin-left: 15%;
        }

        .text_prazo {
            margin-left: 16%;
        }

        .text_linha_2 {
            max-width: 800px;
            display: flex;

        }

        .text_estado {
            margin-left: 5%;
        }

        .text_cidade {
            margin-left: 25%;
        }

        .text_contato {
            margin-left: 40%;
        }

        .text_linha_3 {
            max-width: 800px;
            display: flex;
            margin-top: 15px;
        }

        .text_endereco {
            margin-left: 5%;
        }

        .text_bairro {
            margin-left: 48%;
        }

        .text_linha_4 {
            max-width: 800px;
            display: flex;
            margin-top: 20px;
        }

        .text_apto {
            margin-left: 5%;
        }

        .text_numero {
            margin-left: 39%;
        }


        .text_linha_5 {
            max-width: 800px;
            display: flex;
            margin-top: 10px;
        }

        .text_info {
            margin-left: 4%;
        }

        .next-input-info {
            width: 953px;
            height: 52px;
            padding: 8px;
            margin-top: 10px;
            margin-left: 2.8%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .alertas {
            max-width: 900px;
            display: flex;
        }

        #estado-error {
            margin-left: 4%;
            margin-top: 10px;
        }

        #cidade-error {
            margin-left: 11%;
            /* isso pode não ser necessário se estiver usando flex */
            margin-top: 10px;
        }

        #cep-error {
            margin-left: 33%;
            /* isso pode não ser necessário se estiver usando flex */
            margin-top: 10px;
        }

        .error-input {
            border: 1px solid red;
        }


        .next-form-item-help {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
        }

        .next-form-item-help .help-inner__tip-wrap {
            font-size: 12px;
            color: red;
        }

        .next-checkbox-label {
            font-size: 14px;
            color: #888;
            margin-left: 5px;
        }



        .next-input-obs {
            width: 950px;
            height: 52px;
            padding: 8px;
            margin-top: 10px;
            margin-left: 3%;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 5px;
        }

        .text_linha_frete {
            max-width: 900px;
            margin-top: 10px;
            display: flex;
        }

        .text_obs {
            margin-left: 50%;
        }

        .button-confirm {
            position: absolute;
            overflow: hidden;
            background-color: #007bff;
            color: #fff;
            border: none;
            width: 180px;
            height: 54px;
            cursor: pointer;
            font-size: 16px;
            line-height: 24px;
            border-radius: 22px;
            transition: all 0.3s ease;
            margin-left: 50%;
            margin-top: -5%;
        }

        .button-cancel {
            position: absolute;
            overflow: hidden;
            background-color: #007bff;
            color: #fff;
            border: none;
            width: 180px;
            height: 54px;
            cursor: pointer;
            font-size: 16px;
            line-height: 24px;
            border-radius: 22px;
            transition: all 0.3s ease;
            margin-left: 75%;
            margin-top: -5%;
        }

        .button-confirm span {
            position: relative;
            z-index: 1;
        }

        .button-confirm:before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 100%;
            background-color: #fff;
            opacity: 0.2;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
        }

        .button-confirm:hover:before {
            width: 100%;
        }

        .button-confirm:hover {
            color: #007bff;
            background-color: #fff;
        }

        .button-cancel span {
            position: relative;
            z-index: 1;
        }

        .button-cancel:before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 100%;
            background-color: #fff;
            opacity: 0.2;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
        }

        .button-cancel:hover:before {
            width: 100%;
        }

        .button-cancel:hover {
            color: #007bff;
            background-color: #fff;
        }

        .andes-form-control {
            margin-top: 10px;
            margin-left: 10%;
            display: flex;
        }

        .andes-radioGroup {
            display: flex;
            margin-top: 0px;
        }

        .andes-radio--suffix {
            display: flex;
        }

        .andes-radio {
            padding: 5px 16px 5px 0;
        }

        .andes-radio {
            -webkit-align-items: center;
            align-items: center;
            display: -webkit-flex;
            display: flex;
            font-family: Proxima Nova, -apple-system, Roboto, Arial, sans-serif;
            font-size: 18px;
            padding: 5px 16px 5px 6px;

        }


        .andes-form-control {
            -webkit-font-smoothing: antialiased;
            display: block;
            font-family: Proxima Nova, -apple-system, Helvetica Neue, Helvetica, Roboto, Arial, sans-serif;
            font-size: 18px;
            font-weight: 400;
            padding-top: 1.666667em;
            position: relative;
            text-align: left;
        }

        .andes-radio--suffix .andes-radio__label {
            -webkit-order: 3;
            order: 3;
        }

        .andes-radio__label {
            -webkit-font-smoothing: antialiased;
            color: rgba(0, 0, 0, .9);
            cursor: pointer;
            display: inline-block;
            font-weight: 400;
            margin-bottom: 0;
            outline: none;
            padding-left: 2px;
            position: relative;
        }

        .andes-radio--suffix .icon-radio {
            -webkit-order: 2;
            order: 2;
            padding: 0 5px 0 4px;
        }

        .form-section-e-mail {
            margin-left: 47%;
        }

        .form-section_1 {
            margin-top: 1%;
        }
    </style>

    <button id="myBtn">Abrir Modal</button>

    <div id="myModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="fecharPopup()">&times;</span>
            <div class="comet-modal-title">Adicionar novo Endereço</div>
            <div class="comet-modal-body">
                <form id="enderecoForm" onsubmit="handleSubmit(event)">
                    <div class="form-section_1">
                        <div class="section-body">
                            <div class="next-row form-row-wrap">
                                <div class="next-col">
                                    <div class="next-form-item">

                                        <div class="text_linha_1">
                                            <div class="text_nome"> Nome completo </div>
                                            <div class="text_cep"> CEP </div>
                                            <div class="text_prazo"> Prazo </div>
                                            <div class="text_frete"> Frete </div>
                                        </div>

                                        <input class="next-input" id="nome" name="nome" placeholder=""
                                            autocomplete="off" value="" required oninput="validarLetras(this)">

                                        <input class="next-input-cep" id="cep" name="cep" placeholder=""
                                            autocomplete="off" value="" required
                                            oninput="validarCEP(this); validarNumeros(this);"
                                            onchange="formatarCEP(this); buscarFrete(this.value);">

                                        <input class="next-input-prazo" type="text" id="prazo" name="prazo" disabled
                                            readonly>

                                        <input class="next-input-frete" type="text" id="frete" name="frete" disabled
                                            readonly>


                                        <div class="alertas_1">
                                            <div id="warningMessage_nome" style="color: red;"></div>
                                            <div id="cep-error" style="color: red; display: none;"></div>

                                        </div>

                                        <div class="text_linha_frete">
                                            <div class="text_obs"> Observação </div>
                                        </div>


                                        <input class="next-input-obs" type="text" id="obs" name="obs" disabled readonly>



                                    </div>


                                </div>

                            </div>

                        </div>

                    </div>


                    <div class="form-section">

                        <div class="section-body">
                            <div class="next-row form-row-wrap">
                                <div class="next-col">
                                    <div class="next-form-item">


                                        <div class="text_linha_2">
                                            <div class="text_estado"> Estado </div>
                                            <div class="text_cidade"> Cidade </div>
                                            <div class="text_contato"> Telefone de contato </div>
                                        </div>

                                        <input class="next-input-estado" id="estado" name="estado" placeholder=""
                                            autocomplete="off" value="" required
                                            oninput="validarEstado(this); validarLetras(this);" disabled>

                                        <input class="next-input-cidade" id="cidade" name="cidade" placeholder=""
                                            autocomplete="off" value="" required
                                            oninput="validarCidade(this); validarLetras(this);" disabled>



                                        <input class="next-input-dd" id="dd" height="100%" name="dd" placeholder=""
                                            autocomplete="off" value="" oninput="limitarCaracteres(this, 3)">

                                        <input class="next-input-telefone" id="telefone" name="Telefone" placeholder=""
                                            autocomplete="off" value="" required oninput="validarTelefone(this)">

                                        <div class="alertas">
                                            <div id="estado-error" style="color: red; display: none;"></div>
                                            <div id="cidade-error" style="color: red; display: none;"></div>
                                            <div id="warningMessage_dd" style="color: red;"></div>
                                            <div id="warningMessage_telefone" style="color: red;"></div>
                                        </div>


                                        <div class="text_linha_3">
                                            <div class="text_endereco"> Rua/Avenida </div>
                                            <div class="text_bairro"> Bairro </div>
                                        </div>

                                        <input class="next-input-endereco" id="endereco" name="endereco" placeholder=""
                                            autocomplete="off" value="" required oninput="validarEndereco(this)"
                                            oninput="validarLetras(this)">




                                        <input class="next-input-bairro" id="bairro" name="bairro" placeholder=""
                                            autocomplete="off" value="" required oninput="validarBairro(this)"
                                            oninput="validarLetras(this)">



                                        <div class="alertas_2">
                                            <div id="endereco-error" style="color: red; display: none;"></div>
                                            <div id="bairro-error" style="color: red; display: none;"></div>
                                        </div>


                                        <div class="text_linha_4">
                                            <div class="text_apto"> Complemento (opcional) </div>
                                            <div class="text_numero"> Número </div>
                                        </div>

                                        <div class="input-apt">

                                            <input class="next-input-apto" id="apto" name="apto" placeholder=""
                                                autocomplete=" off" value="" oninput="validarApto(this)"
                                                oninput="validarLetras(this)">

                                        </div>

                                        <div style="display: flex; align-items: center;" class="input-numero">

                                            <input class="next-input-numero" id="numero" name="numero" placeholder=""
                                                autocomplete="off" value="" required
                                                oninput="validarNumero(this); validarNumeros(this);">

                                            <div class="input-checkbox">
                                                <input type="checkbox" id="semNumero" class="checkbox-custom"
                                                    name="semNumero" onclick="verificarSemNumero()">
                                                <label for="semNumero">Sem número</label>
                                            </div>
                                        </div>

                                        <div class="alertas_3">
                                            <div id="apto-error" style="color: red; display: none;"></div>
                                            <div id="numero-error" style="color: red; display: none;"></div>
                                        </div>

                                        <div class="text_linha_5">
                                            <div class="text_info"> Informações adicionais deste endereço (opcional)
                                            </div>
                                        </div>

                                        <input class="next-input-info" id="info" name="info"
                                            placeholder="Descrição da fachada, pontos de referência, informações de segurança etc."
                                            autocomplete="off" value="">




                                        <div
                                            class="andes-form-control andes-form-control--error addresses-radio-margin">
                                            <span class="label-radio-delivery">Este é o seu trabalho ou sua casa?</span>
                                            <div required class="andes-radioGroup" role="radiogroup" aria-labelledby="">
                                                <div
                                                    class="andes-radio andes-radio--default andes-radio--inline andes-radio--suffix">
                                                    <div class="andes-radio-element"><input type="radio"
                                                            class="andes-radio__input" id="commercial"
                                                            name="delivery_group" value="commercial">
                                                        <div class="andes-radio__background">
                                                            <div class="andes-radio__outer-circle"></div>
                                                            <div class="andes-radio__inner-circle"></div>
                                                        </div>
                                                    </div><label class="andes-radio__label"
                                                        for="commercial"><span>Trabalho</span></label><i
                                                        class="icon-radio"> <svg width="14" height="13"
                                                            viewBox="0 0 14 13" fill="rgba(0, 0, 0, 0.8)"
                                                            xmlns="http://www.w3.org/2000/svg">
                                                            <path
                                                                d="M13 3.3224H10.7333V0.48388C10.7333 0.216778 10.5093 0 10.2333 0H3.76667C3.49067 0 3.26667 0.216778 3.26667 0.48388V3.3224H1C0.448 3.3224 0 3.75595 0 4.29015V12.0322C0 12.5664 0.448 13 1 13H13C13.552 13 14 12.5664 14 12.0322V4.29015C14 3.75595 13.552 3.3224 13 3.3224ZM9 3.3224H5V1.19282H9V3.3224Z"
                                                                fill="#4A4A4A"></path>
                                                        </svg> </i>
                                                </div>
                                                <div required
                                                    class="andes-radio andes-radio--default andes-radio--inline andes-radio--suffix">
                                                    <div class="andes-radio-element"><input type="radio"
                                                            class="andes-radio__input" id="residential"
                                                            name="delivery_group" value="residential">
                                                        <div class="andes-radio__background">
                                                            <div class="andes-radio__outer-circle"></div>
                                                            <div class="andes-radio__inner-circle"></div>
                                                        </div>
                                                    </div><label class="andes-radio__label"
                                                        for="residential"><span>Casa</span></label><i
                                                        class="icon-radio"> <svg width="14" height="15"
                                                            viewBox="0 0 14 15" fill="rgba(0, 0, 0, 0.8)"
                                                            xmlns="http://www.w3.org/2000/svg">
                                                            <path
                                                                d="M13.262 7.828L12.0873 6.82625V15H8.61539V10.2316H5.38462V15H1.85958V6.81021L0.790769 7.828L0 7.08143L7 0L14 7.08143L13.262 7.828Z"
                                                                fill="#4A4A4A"></path>
                                                        </svg> </i>
                                                </div>
                                            </div>
                                            <button type="button" onclick="salvarInformacoes()"
                                                class="comet-btn comet-btn-primary comet-btn-large form-item-button button-confirm">
                                                <span>Confirm</span>
                                            </button>
                                            <button type="button" onclick="fecharPopup()"
                                                class="comet-btn comet-btn-normal comet-btn-large form-item-button button-cancel">
                                                <span>Cancel</span>
                                            </button>


                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Função para abrir o popup
        function abrirPopup() {
            const popup = document.getElementById('enderecoPopup');
            popup.style.display = 'block'; // Exibir o popup
        }

        // Função para buscar o endereço com base no CEP
        function buscarEndereco(cep) {
            const url = `http://localhost:3000/endereco/${cep}`;

            // const baseUrl = ''; // Deixe em branco para usar uma URL relativa
            // const url = `${baseUrl}/endereco/${cep}`;

            fetch(url)
                .then(response => response.json())
                .then(data => preencherEndereco(data))
                .catch(error => console.log(error));
        }


        // Função para buscar o valor do frete com base no CEP

        function buscarFrete(cep) {
            const url = `http://localhost:3000/frete/${cep}`;

            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Dados processados', data);
                    exibirFrete(data);
                })
                .catch(error => {
                    console.error('Erro ao buscar frete', error);
                    exibirFrete({ erro: true }); // Display an error message on the page
                });
        }



        function exibirFrete(data) {
            const freteInput = document.getElementById('frete');
            const prazoInput = document.getElementById('prazo');
            const obsInput = document.getElementById('obs'); // Assuming you have an input field with id 'obs'

            if (freteInput && prazoInput && obsInput) {
                // Check if there's an error or if the data array is empty
                if (data.erro || data.length === 0 || !data[0].Valor) {
                    freteInput.value = 'Frete não encontrado';
                    prazoInput.value = ''; // Clear the delivery time field in case of an error
                    obsInput.value = ''; // Clear the 'obsFim' field in case of an error
                } else {
                    // Replace commas with dots and convert the string to a number
                    const freightValue = parseFloat(data[0].Valor.replace(',', '.'));
                    freteInput.value = 'R$ ' + freightValue.toFixed(2); // Show the value with two decimal places

                    // Set the delivery time
                    prazoInput.value = data[0].PrazoEntrega + ' dias'; // Append 'days' to the delivery time

                    // Set the 'obsFim' value
                    obsInput.value = data[0].obsFim;

                    // If 'obsFim' is empty, set a default message
                    if (data[0].obsFim === '') {
                        obsInput.value = 'Nenhuma observação adicional.';
                    }
                }
            }
        }



        // Função para preencher o endereço no formulário
        function preencherEndereco(endereco) {
            const enderecoInput = document.getElementById('endereco');
            const numeroInput = document.getElementById('numero');
            const bairroInput = document.getElementById('bairro');
            const cidadeInput = document.getElementById('cidade');
            const estadoInput = document.getElementById('estado');
            const ddInput = document.getElementById('dd');

            if (enderecoInput) {
                if (endereco.erro) {
                    enderecoInput.value = 'Endereço não encontrado';
                    numeroInput.value = '';
                    bairroInput.value = '';
                    cidadeInput.value = '';
                    estadoInput.value = '';
                    ddInput.value = '';
                } else {
                    enderecoInput.value = endereco.logradouro || '';
                    numeroInput.value = '';
                    bairroInput.value = endereco.bairro || '';
                    cidadeInput.value = endereco.cidade || '';
                    estadoInput.value = endereco.estado || '';
                    ddInput.value = endereco.dd || '';
                }
            }
        }



        // Função para lidar com o envio do formulário
        function handleSubmit(event) {
            event.preventDefault(); // Impedir o envio do formulário

            const cep = document.getElementById('cep').value;
            buscarEndereco(cep);
        }


        function limitarCaracteres(input, maxLength) {
            const warningMessage = document.getElementById("warningMessage_dd");

            if (input.value.length > maxLength) {
                input.value = input.value.slice(0, maxLength); // Limita o número de caracteres
                warningMessage.innerText = "O número de dígitos deve ser no máximo 8.";
                input.classList.add("error-input"); // Adiciona a classe CSS para destacar o campo em vermelho
            } else if (input.value.length === 0) {
                warningMessage.innerText = "Você deve incluir o código do país."; // Adiciona mensagem de aviso quando a caixa estiver vazia
                input.classList.add("error-input"); // Adiciona a classe CSS para destacar o campo em vermelho
            } else {
                warningMessage.innerText = ""; // Limpa a mensagem de aviso
                input.classList.remove("error-input"); // Remove a classe CSS caso o valor seja válido
            }
        }

        function validarTelefone(input) {
            const warningMessage = document.getElementById("warningMessage_telefone");
            const numericValue = input.value.replace(/\D/g, ""); // Remove caracteres não numéricos

            if (numericValue !== input.value) {
                input.value = numericValue; // Atualiza o valor do campo de input para conter apenas números
                input.classList.add("error-input"); // Adiciona a classe CSS para destacar o campo em vermelho
                warningMessage.innerText = "Insira 10 ou 11 dígitos.";
            } else if (input.value.length === 0) {
                warningMessage.innerText = "Insira o seu número de celular."; // Adiciona mensagem de aviso quando a caixa estiver vazia
                input.classList.add("error-input"); // Adiciona a classe CSS para destacar o campo em vermelho
            } else if (numericValue.length > 8) {
                input.value = numericValue.slice(0, 9); // Limita o número de dígitos para 8
                var numericos = input.value.replace(/\D/g, ''); // Remove todos os caracteres não numéricos
                var formatado = numericos.replace(/(\d{2})(\d{4,5})(\d{4})$/, "($1) $2-$3");
                input.value = formatado;
                input.classList.add("error-input"); // Adiciona a classe CSS para destacar o campo em vermelho
                warningMessage.innerText = "Insira no máximo 9 dígitos.";
            } else {
                var numericos = input.value.replace(/\D/g, ''); // Remove todos os caracteres não numéricos
                var formatado = numericos.replace(/(\d{2})(\d{4,5})(\d{4})$/, "($1) $2-$3");
                input.value = formatado;
                input.classList.remove("error-input"); // Remove a classe CSS caso o valor seja válido
                warningMessage.innerText = ""; // Limpa a mensagem de aviso
            }
        }

        function validarLetras(input) {
            const warningMessage = document.getElementById("warningMessage_nome");
            const alphaRegex = /^[a-zA-Z\s]*$/; // Expressão regular para letras e espaços

            if (!alphaRegex.test(input.value)) {
                input.classList.add("error-input"); // Adiciona a classe CSS para destacar o campo em vermelho
                warningMessage.innerText = "Favor adicionar um nome para contato.";
            } else if (input.value.length === 0) {
                warningMessage.innerText = "Este campo é obrigatório."; // Adiciona mensagem de aviso quando a caixa estiver vazia
                input.classList.add("error-input"); // Adiciona a classe CSS para destacar o campo em vermelho
            } else {
                warningMessage.innerText = ""; // Limpa a mensagem de aviso
                input.classList.remove("error-input"); // Remove a classe CSS caso o valor seja válido
            }
        }


        function validarNumeros(input) {
            var num = input.value.replace(/[^0-9]/g, ''); // Remove todos os caracteres não numéricos
            input.value = num;
            var numericos = input.value.replace(/\D/g, ''); // Remove todos os caracteres não numéricos
            var formatado = numericos.replace(/(\d{2})(\d{4,5})(\d{4})$/, "($1) $2-$3");
            input.value = formatado;
        }

        function formatarCEP(input) {
            var num = input.value.replace(/[^0-9]/g, ''); // Remove todos os caracteres não numéricos
            input.value = num;
            const cep = input.value.replace(/\D/g, ''); // Remove todos os caracteres não numéricos
            const cepFormatado = cep.replace(/(\d{5})(\d{3})/, '$1-$2'); // Formata o CEP para "37557-027"
            input.value = cepFormatado;

            const cepNumerico = cep.replace(/\D/g, ''); // Remove todos os caracteres não numéricos do CEP formatado
            buscarEndereco(cepNumerico); // Chama a função buscarEndereco() com o valor formatado do CEP
        }

        function validarNumerosCPF(input) {
            var num = input.value.replace(/[^0-9]/g, ''); // Remove todos os caracteres não numéricos
            input.value = num;
            const value = input.value.replace(/[^0-9]/g, '');
            if (value.length > 11) {
                input.value = value.slice(0, 11);
            } else {
                input.value = value;
            }
        }
        function formatarCPF(input) {
            var num = input.value.replace(/[^0-9]/g, ''); // Remove todos os caracteres não numéricos
            input.value = num;
            let cpf = input.value.replace(/\D/g, ''); // Remove todos os caracteres não numéricos
            cpf = cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4'); // Formata o CPF para "000.000.000-00"
            input.value = cpf;
        }


        function validarEstado(input) {
            var letras = input.value.replace(/[^a-zA-Z]/g, ""); // Remove todos os caracteres não alfabéticos
            input.value = letras;
            const errorDiv = document.getElementById('estado-error');
            if (input.value === '') {
                errorDiv.style.display = 'block';
                errorDiv.innerText = 'Por favor, insira o estado.';
                input.style.border = '1px solid red';  // faz a borda ficar vermelha
            } else {
                errorDiv.style.display = 'none';
                input.style.border = '';  // remove a borda vermelha
            }
        }


        function validarCidade(input) {
            var letras = input.value.replace(/[^a-zA-Z]/g, ""); // Remove todos os caracteres não alfabéticos
            input.value = letras;
            const errorDiv = document.getElementById('cidade-error');
            if (input.value === '') {
                errorDiv.style.display = 'block';
                errorDiv.innerText = 'Por favor, insira a cidade.';
                input.style.border = '1px solid red';  // faz a borda ficar vermelha
            } else {
                errorDiv.style.display = 'none';
                input.style.border = '';  // remove a borda vermelha
            }
        }

        function validarCEP(input) {
            var num = input.value.replace(/[^0-9]/g, ''); // Remove todos os caracteres não numéricos
            input.value = num;
            const errorDiv = document.getElementById('cep-error');
            if (input.value === '') {
                errorDiv.style.display = 'block';
                errorDiv.innerText = 'Por favor, insira o CEP.';
                input.style.border = '1px solid red';  // faz a borda ficar vermelha
            } else if (input.value.length !== 8) {
                errorDiv.style.display = 'block';
                errorDiv.innerText = 'Por favor, insira um CEP válido.';
                input.style.border = '1px solid red';  // faz a borda ficar vermelha
            } else {
                errorDiv.style.display = 'none';
                input.style.border = '';  // remove a borda vermelha
            }
        }


        function validarEndereco(input) {
            var letras = input.value.replace(/[^a-zA-Z]/g, ""); // Remove todos os caracteres não alfabéticos
            input.value = letras;
            const errorDiv = document.getElementById('endereco-error');
            if (input.value === '') {
                errorDiv.style.display = 'block';
                errorDiv.innerText = 'Por favor, insira o endereço.';
                input.style.border = '1px solid red';  // faz a borda ficar vermelha
            } else {
                errorDiv.style.display = 'none';
                input.style.border = '';  // remove a borda vermelha
            }
        }

        function validarBairro(input) {
            var letras = input.value.replace(/[^a-zA-Z]/g, ""); // Remove todos os caracteres não alfabéticos
            input.value = letras;
            const errorDiv = document.getElementById('bairro-error');
            if (input.value === '') {
                errorDiv.style.display = 'block';
                errorDiv.innerText = 'Por favor, insira o bairro.';
                input.style.border = '1px solid red';  // faz a borda ficar vermelha
            } else {
                errorDiv.style.display = 'none';
                input.style.border = '';  // remove a borda vermelha
            }
        }

        function validarApto(input) {
            var letras = input.value.replace(/[^a-zA-Z]/g, ""); // Remove todos os caracteres não alfabéticos
            input.value = letras;
            const errorDiv = document.getElementById('apto-error');
            if (input.value === '') {
                errorDiv.style.display = 'block';
                errorDiv.innerText = 'Por favor, insira o número do apartamento.';
                input.style.border = '1px solid red';  // faz a borda ficar vermelha
            } else {
                errorDiv.style.display = 'none';
                input.style.border = '';  // remove a borda vermelha
            }
        }

        function validarNumero(input) {
            var num = input.value.replace(/[^0-9]/g, ''); // Remove todos os caracteres não numéricos
            input.value = num;
            const errorDiv = document.getElementById('numero-error');
            if (input.value === '') {
                errorDiv.style.display = 'block';
                errorDiv.innerText = 'Por favor, insira o número.';
                input.style.border = '1px solid red';  // faz a borda ficar vermelha
            } else {
                errorDiv.style.display = 'none';
                input.style.border = '';  // remove a borda vermelha
            }
        }

        function verificarSemNumero() {
            var checkbox = document.getElementById('semNumero');
            var numeroInput = document.getElementById('numero');

            if (checkbox.checked) {
                numeroInput.value = 'S/N';
                numeroInput.disabled = true;  // Desativa o campo para impedir modificações
            } else {
                numeroInput.value = '';
                numeroInput.disabled = false;  // Reativa o campo para permitir modificações
            }
        }


        // Função para abrir o modal
        function exibirEndereco() {
            var modal = document.getElementById("myModal");
            modal.style.display = "block";
        }

        // Função para fechar o modal e limpar os inputs
        function fecharPopup() {
            var modals = document.getElementsByClassName("modal");
            for (var i = 0; i < modals.length; i++) {
                modals[i].style.display = "none";
            }

            var popups = document.getElementsByClassName("popup");
            for (var j = 0; j < popups.length; j++) {
                popups[j].style.display = "none";
            }

            // Limpar os campos de input
            document.getElementById("nome").value = "";
            document.getElementById("cep").value = "";
            // Adicione aqui o código para limpar os outros campos de input
            document.getElementById("prazo").value = "";
            document.getElementById("frete").value = "";
            document.getElementById("obs").value = "";
            document.getElementById("estado").value = "";
            document.getElementById("cidade").value = "";
            document.getElementById("dd").value = "";
            document.getElementById("telefone").value = "";
            document.getElementById("endereco").value = "";
            document.getElementById("bairro").value = "";
            document.getElementById("apto").value = "";
            document.getElementById("numero").value = "";
            document.getElementById("info").value = "";
            document.getElementById("commercial").value = "";
            document.getElementById("residential").value = "";
        }


        // Função para salvar as informações e fechar o modal
        function salvarInformacoes() {
            var nome = document.getElementById("nome").value;
            var cep = document.getElementById("cep").value;
            var prazo = document.getElementById("prazo").value;
            var frete = document.getElementById("frete").value;
            var obs = document.getElementById("obs").value;
            var estado = document.getElementById("estado").value;
            var cidade = document.getElementById("cidade").value;
            var dd = document.getElementById("dd").value;
            var Telefone = document.getElementById("telefone").value;
            var endereco = document.getElementById("endereco").value;
            var bairro = document.getElementById("bairro").value;
            var apto = document.getElementById("apto").value;
            var numero = document.getElementById("numero").value;
            var info = document.getElementById("info").value;
            var commercial = document.getElementById("commercial").value;
            var residential = document.getElementById("residential").value;

            // Verificar se todos os campos obrigatórios estão preenchidos
            if (
                nome === "" ||
                cep === "" ||
                prazo === "" ||
                frete === "" ||
                obs === "" ||
                estado === "" ||
                cidade === "" ||
                dd === "" ||
                Telefone === "" ||
                endereco === "" ||
                bairro === "" ||
                numero === "" ||
                commercial === "" ||
                residential === "" 
            ) {
                alert("Por favor, preencha todos os campos obrigatórios.");
                return; // Impedir o salvamento e fechamento do modal se algum campo estiver vazio
            }

            // Salvar as informações localmente usando o localStorage
            localStorage.setItem("nome", nome);
            localStorage.setItem("cep", cep);
            localStorage.setItem("prazo", prazo);
            localStorage.setItem("frete", frete);
            localStorage.setItem("obs", obs);
            localStorage.setItem("estado", estado);
            localStorage.setItem("cidade", cidade);
            localStorage.setItem("telefone", Telefone);
            localStorage.setItem("endereço", endereco);
            localStorage.setItem("bairro", bairro);
            localStorage.setItem("apto", apto);
            localStorage.setItem("numero", numero);
            localStorage.setItem("info", info);
            localStorage.setItem("commercial", commercial);
            localStorage.setItem("residencial", residential);

            fecharPopup();
        }


        // Evento de clique no botão "Confirmar"
        document.getElementById("myBtn").onclick = exibirEndereco;

        // Evento de clique fora do modal para fechá-lo
        window.onclick = function (event) {
            var modal = document.getElementById("myModal");
            if (event.target == modal) {
                fecharPopup();
            }
        }


    </script>



    </body>

</html>